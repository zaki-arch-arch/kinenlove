<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ãƒˆã‚­ãƒ¡ã‚­ç¦ç…™ãƒ¡ãƒ¢ãƒªã‚¢ãƒ« v7.0</title>
    
    <!-- Tailwind CSS (ãƒ‡ã‚¶ã‚¤ãƒ³ç”¨) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° -->
    <script>
        window.onerror = function(msg, url, line) {
            var el = document.getElementById('error-toast');
            if(el) {
                el.innerHTML = 'âš ï¸ ã‚¨ãƒ©ãƒ¼: ' + msg;
                el.style.display = 'block';
                setTimeout(function(){ el.style.display='none'; }, 5000);
            }
            return false;
        };
    </script>

    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #fff1f2; /* rose-50 */
            color: #334155; /* slate-700 */
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: none;
            user-select: none;
        }
        
        /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼éš ã— */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        @keyframes breathe { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
        .animate-breathe { animation: breathe 6s ease-in-out infinite; }
        
        @keyframes tap { 0% { transform: scale(1); } 50% { transform: scale(0.95); } 100% { transform: scale(1); } }
        .animate-tap { animation: tap 0.2s ease-in-out; }

        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-5px); } 100% { transform: translateY(0px); } }
        .animate-float { animation: float 4s ease-in-out infinite; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }

        @keyframes pulse-slow { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .animate-pulse-slow { animation: pulse-slow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    </style>
</head>
<body class="bg-rose-50 text-slate-700 min-h-screen">

    <!-- ã‚¢ãƒ—ãƒªæç”»ã‚¨ãƒªã‚¢ -->
    <div id="app" class="w-full min-h-screen relative overflow-hidden">
        <!-- ãƒ­ãƒ¼ãƒ‰ä¸­ç”»é¢ -->
        <div id="loading" class="fixed inset-0 bg-rose-50 flex flex-col items-center justify-center z-50">
            <div class="text-5xl mb-4 animate-bounce">ğŸ’—</div>
            <div class="font-bold text-rose-400">Loading...</div>
            <button onclick="fullReset()" class="mt-8 text-xs text-gray-400 underline">èµ·å‹•ã—ãªã„å ´åˆã¯ãƒªã‚»ãƒƒãƒˆ</button>
        </div>
    </div>

    <!-- ã‚¨ãƒ©ãƒ¼é€šçŸ¥ -->
    <div id="error-toast" class="fixed top-0 left-0 w-full bg-red-500 text-white p-2 text-xs text-center z-[9999] hidden"></div>

    <script>
        // --- è¨­å®šãƒ»ãƒ‡ãƒ¼ã‚¿ ---
        var APP_KEY = 'tokikin_v7_0';
        
        // ã‚¢ã‚¤ã‚³ãƒ³ (SVGæ–‡å­—åˆ—)
        var ICONS = {
            Heart: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>',
            Trash: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>',
            Clock: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>',
            Wallet: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" /></svg>',
            Activity: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>',
            Alert: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>',
            Check: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>',
            Camera: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" class="w-8 h-8"><path stroke-linecap="round" stroke-linejoin="round" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" /></svg>',
            X: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>'
        };

        var GIFTS = [
            { id: 1, name: 'ã‚¹ã‚¤ãƒ¼ãƒ„', cost: 500, icon: 'ğŸ°', love: 15 },
            { id: 2, name: 'ã‚³ã‚¹ãƒ¡', cost: 3000, icon: 'ğŸ’„', love: 80 },
            { id: 3, name: 'æ¸©æ³‰æ—…è¡Œ', cost: 15000, icon: 'â™¨ï¸', love: 450 },
            { id: 4, name: 'æ„›ã®èª“ã„', cost: 100000, icon: 'ğŸ’', love: 2500 }
        ];

        var SCENARIO = {
            morning: ["ãŠã¯ã‚ˆã†ï¼ä»Šæ—¥ã‚‚è‚ºã‚’ã‚­ãƒ¬ã‚¤ã«ä¿ã¨ã†ã­ï¼", "æœã®æ·±å‘¼å¸ã€æ°—æŒã¡ã„ã„ï¼Ÿ", "ä»Šæ—¥ã‚‚è¨˜éŒ²æ›´æ–°é ‘å¼µã‚ã†ï¼"],
            day: ["ãŠç–²ã‚Œæ§˜ï¼æ°´é£²ã‚“ã§ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ã‚ˆï¼Ÿ", "åˆå¾Œã®çœ æ°—ã¯ã‚¹ãƒˆãƒ¬ãƒƒãƒã§é£›ã°ãã†ï¼", "é ‘å¼µã£ã¦ã‚‹ã­ï¼ã™ã”ã„ã‚ˆã€‚"],
            night: ["ä»Šæ—¥ã‚‚ãŠç–²ã‚Œæ§˜ã€‚å¸ã‚ãšã«å‰ã„ï¼", "æ˜æ—¥ã®ç›®è¦šã‚ãŒæ¥½ã—ã¿ã ã­ã€‚", "ã‚†ã£ãã‚ŠãŠé¢¨å‘‚ã«å…¥ã£ã¦ä¼‘ã‚“ã§ã­ã€‚"],
            lateNight: ["ã¾ã èµ·ãã¦ã‚‹ã®ï¼Ÿæ—©ãå¯ãªã„ã¨è‚Œã«æ‚ªã„ã‚ˆã€‚", "ã“ã‚“ãªæ™‚é–“ã¾ã§èµ·ãã¦ã¦å¤§ä¸ˆå¤«ï¼Ÿ"]
        };

        var HEALTH_BENEFITS = [
            { hours: 0, title: "ã‚¹ã‚¿ãƒ¼ãƒˆï¼", text: "ã¾ãšã¯æ·±å‘¼å¸ï¼ä½“å†…ã®ä¸€é…¸åŒ–ç‚­ç´ æ’å‡ºãŒå§‹ã¾ã‚Šã¾ã™ã€‚" },
            { hours: 24, title: "ãƒªã‚¹ã‚¯ä½ä¸‹", text: "24æ™‚é–“é”æˆï¼å¿ƒè‡“ã¸ã®è² æ‹…ãŒæ¸›ã‚Šå§‹ã‚ã¦ã„ã¾ã™ã€‚" },
            { hours: 72, title: "ãƒ‹ã‚³ãƒãƒ³æ¶ˆå¤±", text: "ä½“å†…ã‹ã‚‰ãƒ‹ã‚³ãƒãƒ³ãŒå®Œå…¨ã«æŠœã‘ã¾ã—ãŸï¼" },
            { hours: 168, title: "ç¡çœ æ”¹å–„", text: "1é€±é–“é”æˆï¼ç›®è¦šã‚ãŒã‚¹ãƒƒã‚­ãƒªã—ã¾ã™ã€‚" },
            { hours: 720, title: "ç¾è‚ŒåŠ¹æœ", text: "1ãƒ¶æœˆé”æˆï¼è‚Œã®ãƒˆãƒ¼ãƒ³ãŒæ˜ã‚‹ããªã‚Šã¾ã™ã€‚" },
            { hours: 8760, title: "å¥åº·ä½“", text: "1å¹´é”æˆï¼å¿ƒè‡“ç—…ãƒªã‚¹ã‚¯ãŒåŠæ¸›ã—ã¾ã—ãŸï¼" }
        ];

        // --- çŠ¶æ…‹ç®¡ç† ---
        var state = {
            view: 'loading',
            profile: null,
            heroines: [],
            regMode: 'normal',
            previewImages: { normal: null, happy: null, sad: null },
            timer: { d:0, h:0, m:0, s:0, wallet:0, totalSaved:0, totalHours:0 },
            isSosMode: false,
            modal: null, // 'reset', 'sos', 'popup'
            popup: null,
            dialogue: ""
        };

        // --- åˆæœŸåŒ– ---
        window.onload = function() {
            if (loadData() && state.profile.startQuitDate) {
                state.view = 'main';
                updateDialogue();
            } else {
                state.profile = { dailyTarget: 20, pricePerPack: 600, money: 0, love: 0, goalName: '', goalCost: 0, lastLoginDate: null, giftHistory: {} };
                state.view = 'setup';
            }
            // ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹
            setInterval(tick, 1000);
            render();
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ¶ˆå»
            var loading = document.getElementById('loading');
            if(loading) loading.style.display = 'none';
        };

        // --- ãƒ­ã‚¸ãƒƒã‚¯ ---
        function loadData() {
            try {
                var p = localStorage.getItem(APP_KEY + '_profile');
                var h = localStorage.getItem(APP_KEY + '_heroines');
                if (p && h) {
                    state.profile = JSON.parse(p);
                    state.heroines = JSON.parse(h);
                    return true;
                }
            } catch(e) {}
            return false;
        }

        function saveData() {
            try {
                localStorage.setItem(APP_KEY + '_profile', JSON.stringify(state.profile));
                localStorage.setItem(APP_KEY + '_heroines', JSON.stringify(state.heroines));
                return true;
            } catch(e) { 
                alert('ä¿å­˜å®¹é‡ãŒã„ã£ã±ã„ã§ã™ã€‚ç”»åƒã‚’æ¸›ã‚‰ã—ã¦ãã ã•ã„ã€‚');
                return false; 
            }
        }

        function fullReset() {
            if(confirm('å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¦åˆæœŸåŒ–ã—ã¾ã™ã‹ï¼Ÿ')) {
                Object.keys(localStorage).forEach(function(k){
                    if(k.indexOf(APP_KEY) === 0) localStorage.removeItem(k);
                });
                location.reload();
            }
        }

        function tick() {
            if (!state.profile || !state.profile.startQuitDate) return;
            var now = new Date();
            var start = new Date(state.profile.startQuitDate);
            var diff = now - start;
            if (diff < 0) return;

            state.timer.d = Math.floor(diff / (1000 * 60 * 60 * 24));
            state.timer.h = Math.floor((diff / (1000 * 60 * 60)) % 24);
            state.timer.m = Math.floor((diff / (1000 * 60)) % 60);
            state.timer.s = Math.floor((diff / 1000) % 60);

            var totalHours = diff / (1000 * 60 * 60);
            state.timer.totalHours = totalHours;

            var totalDays = diff / (1000 * 60 * 60 * 24);
            state.timer.totalSaved = Math.floor(totalDays * state.profile.dailyTarget * (state.profile.pricePerPack / 20));
            state.timer.wallet = (state.profile.accumulatedMoney || 0) + state.timer.totalSaved;

            if (state.view === 'main') renderMainDynamic();
        }

        function updateDialogue() {
            var h = new Date().getHours();
            var key = (h >= 5 && h < 11) ? 'morning' : (h >= 11 && h < 18) ? 'day' : (h >= 23 || h < 4) ? 'lateNight' : 'night';
            var list = SCENARIO[key];
            state.dialogue = list[Math.floor(Math.random() * list.length)];
            var el = document.getElementById('dialogue-text');
            if(el) el.innerText = state.dialogue;
        }

        function resizeImage(file, callback) {
            var reader = new FileReader();
            reader.onload = function(e) {
                var img = new Image();
                img.onload = function() {
                    var canvas = document.createElement('canvas');
                    var max = 500;
                    var w = img.width; var h = img.height;
                    if (w > h) { if (w > max) { h *= max/w; w = max; } } else { if (h > max) { w *= max/h; h = max; } }
                    canvas.width = w; canvas.height = h;
                    var ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, w, h);
                    callback(canvas.toDataURL('image/jpeg', 0.7));
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        // --- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ ---
        function handleFile(input, type) {
            if (input.files && input.files[0]) {
                resizeImage(input.files[0], function(base64) {
                    state.previewImages[type] = base64;
                    render();
                });
            }
        }

        function setRegMode(mode) {
            state.regMode = mode;
            render();
        }

        function setupNext() {
            state.profile.dailyTarget = parseInt(document.getElementById('inp-c').value);
            state.profile.pricePerPack = parseInt(document.getElementById('inp-p').value);
            state.profile.goalName = document.getElementById('inp-gn').value;
            state.profile.goalCost = parseInt(document.getElementById('inp-gc').value) || 0;
            state.view = 'char_reg';
            render();
        }

        function startApp() {
            if (!state.previewImages.normal) return alert('é€šå¸¸ç”»åƒã¯å¿…é ˆã§ã™');
            var h = {
                id: Date.now().toString(),
                img: state.previewImages.normal,
                imgHappy: state.previewImages.happy || state.previewImages.normal,
                imgSad: state.previewImages.sad || state.previewImages.normal
            };
            state.heroines = [h];
            state.profile.currentHeroineId = h.id;
            state.profile.startQuitDate = new Date().toISOString();
            if(saveData()) {
                state.view = 'main';
                render();
                updateDialogue();
            }
        }

        function buyGift(idx) {
            var g = GIFTS[idx];
            if (state.timer.wallet < g.cost) return alert('ãŠé‡‘ãŒè¶³ã‚Šã¾ã›ã‚“');
            state.profile.love += g.love;
            state.profile.accumulatedMoney = (state.profile.accumulatedMoney || 0) - g.cost;
            var hist = state.profile.giftHistory || {};
            hist[g.id] = (hist[g.id] || 0) + 1;
            state.profile.giftHistory = hist;
            save();
            
            // æ¼”å‡º
            showPopup('ğŸ ' + g.name, 'ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã—ã¾ã—ãŸï¼', 'å¥½æ„Ÿåº¦ +' + g.love, true);
            render();
        }

        function showPopup(title, msg, sub, isHappy) {
            state.popup = { title:title, msg:msg, sub:sub, isHappy:isHappy };
            state.modal = 'popup';
            render();
        }

        function closePopup() {
            state.modal = null;
            state.popup = null;
            render();
        }

        function openSos() { state.isSosMode = true; state.modal = 'sos'; render(); }
        function closeSos() { state.isSosMode = false; state.modal = null; render(); }
        
        function execPenalty() {
            state.profile.accumulatedMoney = (state.profile.accumulatedMoney || 0) - state.profile.pricePerPack;
            state.profile.love = Math.max(0, state.profile.love - 10);
            save();
            closeSos();
            alert('1æœ¬åˆ†æ²¡åã—ã¾ã—ãŸã€‚');
            render();
        }

        function execReset() {
            state.profile.startQuitDate = new Date().toISOString();
            state.profile.accumulatedMoney = 0;
            state.profile.love = Math.max(0, state.profile.love - 50);
            save();
            closeSos();
            alert('ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸã€‚');
            render();
        }
        
        function openResetModal() { state.modal = 'reset'; render(); }
        function closeResetModal() { state.modal = null; render(); }

        // --- ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° (HTMLæ–‡å­—åˆ—ç”Ÿæˆ) ---
        function render() {
            var app = document.getElementById('app');
            var html = '';

            if (state.view === 'setup') {
                html = `
                <div class="min-h-screen flex items-center justify-center p-6">
                    <div class="bg-white p-8 rounded-3xl shadow-xl w-full max-w-sm space-y-4 animate-float">
                        <h1 class="text-xl font-black text-rose-500 text-center mb-4">ç¦ç…™ãƒ¡ãƒ¢ãƒªã‚¢ãƒ« v7.0</h1>
                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="text-xs font-bold text-slate-500">1æ—¥ã®æœ¬æ•°</label><input id="inp-c" type="number" value="20" class="w-full p-2 bg-rose-50 rounded-lg border"></div>
                            <div><label class="text-xs font-bold text-slate-500">1ç®±ã®å€¤æ®µ</label><input id="inp-p" type="number" value="600" class="w-full p-2 bg-rose-50 rounded-lg border"></div>
                        </div>
                        <div class="pt-2 border-t border-rose-100">
                            <p class="text-xs font-bold text-rose-400 mb-2">âœ¨ ç›®æ¨™ï¼ˆæ¬²ã—ã„ã‚‚ã®ï¼‰</p>
                            <input id="inp-gn" type="text" placeholder="ä¾‹: ç„¼è‚‰" class="w-full p-2 bg-rose-50 rounded-lg mb-2 border">
                            <input id="inp-gc" type="number" placeholder="é‡‘é¡ (å††)" class="w-full p-2 bg-rose-50 rounded-lg border">
                        </div>
                        <button onclick="nextSetup()" class="w-full bg-rose-500 text-white py-4 rounded-full font-bold shadow-lg mt-2 transition active:scale-95">æ¬¡ã¸</button>
                    </div>
                </div>`;
            } else if (state.view === 'char_reg') {
                var img = state.previewImages[state.regMode];
                html = `
                <div class="min-h-screen flex flex-col items-center justify-center p-6">
                    <h2 class="text-xl font-bold text-slate-700 mb-4">ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼è¨­å®š</h2>
                    <div class="flex bg-white rounded-full p-1 shadow-sm mb-4 w-full max-w-xs">
                        <button onclick="setRegMode('normal')" class="flex-1 py-2 text-xs font-bold rounded-full transition ${state.regMode=='normal'?'bg-rose-500 text-white':'text-slate-400'}">é€šå¸¸</button>
                        <button onclick="setRegMode('happy')" class="flex-1 py-2 text-xs font-bold rounded-full transition ${state.regMode=='happy'?'bg-yellow-400 text-white':'text-slate-400'}">ç¬‘é¡”</button>
                        <button onclick="setRegMode('sad')" class="flex-1 py-2 text-xs font-bold rounded-full transition ${state.regMode=='sad'?'bg-blue-500 text-white':'text-slate-400'}">æ‚²ã—ã¿</button>
                    </div>
                    <div class="relative w-64 h-64 bg-white border-4 border-dashed rounded-3xl flex items-center justify-center overflow-hidden shadow-sm mb-6" style="border-color:${state.regMode=='normal'?'#fda4af':state.regMode=='happy'?'#facc15':'#3b82f6'}">
                        ${img ? '<img src="'+img+'" class="w-full h-full object-cover">' : '<div class="text-center p-4 text-slate-300"><div class="mb-1">'+ICONS.Camera+'</div><span class="text-xs font-bold">ç”»åƒã‚’é¸æŠ</span></div>'}
                        <input type="file" accept="image/*" onchange="handleFile(this, '${state.regMode}')" class="absolute inset-0 opacity-0 cursor-pointer w-full h-full">
                    </div>
                    <p class="text-xs text-slate-400 mb-6">â€»ç¬‘é¡”ãƒ»æ‚²ã—ã¿ã¯æœªè¨­å®šã§ã‚‚OK</p>
                    <button onclick="startApp()" class="px-10 py-3 rounded-full font-bold shadow-lg text-white transition active:scale-95 ${state.previewImages.normal ? 'bg-rose-500' : 'bg-gray-300'}">ã“ã‚Œã§å§‹ã‚ã‚‹</button>
                </div>`;
            } else if (state.view === 'main') {
                var h = state.heroines[0];
                var currentImg = h.img;
                if (state.isSosMode) currentImg = h.imgSad;
                else if (state.popup && state.popup.isHappy) currentImg = h.imgHappy;

                // å¥åº·åº¦è¨ˆç®—
                var currentHealth = HEALTH_BENEFITS[0];
                for(var i=0; i<HEALTH_BENEFITS.length; i++) {
                    if (state.timer.totalHours >= HEALTH_BENEFITS[i].hours) currentHealth = HEALTH_BENEFITS[i];
                }

                html = `
                <div class="w-full bg-gradient-to-b from-rose-50 to-white pb-32 min-h-screen">
                    <div class="fixed top-0 left-0 w-full h-80 bg-rose-100 rounded-b-[60px] -z-10 shadow-inner"></div>

                    <!-- Header -->
                    <div class="flex justify-between items-center p-6 pt-10 sticky top-0 z-40 bg-rose-100/80 backdrop-blur-sm rounded-b-2xl">
                        <div class="flex items-center gap-2 text-rose-500 font-bold bg-white/90 px-3 py-1 rounded-full shadow-sm">
                            ${ICONS.Heart} <span>Lv.${Math.floor(state.profile.love/100)+1}</span>
                        </div>
                        <button oncl
